(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{421:function(t,s,e){"use strict";e.r(s);var r=e(42),_=Object(r.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"redis线程模型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redis线程模型"}},[t._v("#")]),t._v(" redis线程模型")]),t._v(" "),e("blockquote",[e("p",[t._v("NIO异步单线程")])]),t._v(" "),e("h2",{attrs:{id:"为什么redis单线程还能支撑高并发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么redis单线程还能支撑高并发"}},[t._v("#")]),t._v(" 为什么redis单线程还能支撑高并发")]),t._v(" "),e("ol",[e("li",[t._v("IO多路复用程序只负责监听所有的socket产生的请求，有人发过来请求就直接放入队列中。")]),t._v(" "),e("li",[t._v("事件处理器是基于纯内存操作的。")]),t._v(" "),e("li",[t._v("单线程反而避免了多线程频繁切换上下文问题。")])]),t._v(" "),e("h2",{attrs:{id:"客户端与redis的通信的一次流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户端与redis的通信的一次流程"}},[t._v("#")]),t._v(" 客户端与redis的通信的一次流程")]),t._v(" "),e("ol",[e("li",[t._v("在redis初始化的时候，redis会将连接应答处理器跟AE_READABLE事件关联起来，接着如果一个客户端与redis发起连接，此时会产生一个AE_READABLE事件，然后由"),e("font",{attrs:{color:"blue"}},[t._v("连接应答处理器")]),t._v("来处理与客户端的连接，创建客户端对应的socket，同时将这个socket的AE_READABLE事件跟"),e("font",{attrs:{color:"blue"}},[t._v("命令请求处理器")]),t._v("关联起来。")],1),t._v(" "),e("li",[t._v("当客户端想redis发起请求的时候，首先会在socket产生一个AE_READABLE事件，然后由"),e("font",{attrs:{color:"blue"}},[t._v("命令请求处理器")]),t._v("来处理，这个命令请求处理器就会从socket中读取请求相关数据，然后进行执行和处理。")],1),t._v(" "),e("li",[t._v("接着redis这边准备好了给客户端的相应数据之后，就会将socket的AE_WRITEABLE事件跟"),e("font",{attrs:{color:"blue"}},[t._v("命令回复处理器")]),t._v("关联起来，当客户端这边准备好读取相应数据时，就会在socket上产生一个AE_WRITEABLE事件，会由"),e("font",{attrs:{color:"blue"}},[t._v("命令回复处理器")]),t._v("来处理，就是准备好写入socket，供客户端来读取。")],1),t._v(" "),e("li",[e("font",{attrs:{color:"blue"}},[t._v("命令回复处理器")]),t._v("写完之后，就会删除这个socket的AE_WRITEABLE事件和"),e("font",{attrs:{color:"blue"}},[t._v("命令回复处理器")]),t._v("的关联关系。")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020121916394029.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMzAyNg==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),t._v(" "),e("h2",{attrs:{id:"附录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[t._v("#")]),t._v(" 附录")]),t._v(" "),e("p",[t._v("redis在线程有顺序性")]),t._v(" "),e("p",[e("strong",[t._v("Redis是二进制安全的")])]),t._v(" "),e("p",[t._v("客户端通过socket访问redis，redis拿到字节流")])])}),[],!1,null,null,null);s.default=_.exports}}]);